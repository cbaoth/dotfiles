# ~/.myenv: Common environment to be sourced as needed (.zshenv and .profile)
# code: language=shell
#
# Author:  cbaoth <dev@cbaoth.de>
# Keywords: zsh zshenv bash profile shell-script

# {{{ = ENVIRONMENT (ALL SHELLS) =============================================
# {{{ - PATHS ----------------------------------------------------------------
export PATH="${HOME}/bin:${HOME}/.local/bin:/opt/bin:/snap/bin"\
":/usr/local/bin:/usr/bin:/bin"\
":/usr/local/sbin:/usr/sbin:/sbin"\
":/usr/bin/X11:/usr/X11R6/bin:/usr/games"\
":/opt/oracle/instantclient_21_4"\
"${PATH:+:${PATH}}"
export LD_LIBRARY_PATH="${LD_LIBRARY_PATH:+${LD_LIBRARY_PATH}:}/usr/local/lib"
# }}} - PATHS ----------------------------------------------------------------

# {{{ - LOCALE ---------------------------------------------------------------
#export LANG=C
export LANG="en_US.UTF-8"
# LC_* should not be set globally since they are usually inherited from LANG
# If really needed use temporary env override(s) instead
#export LC_ALL="en_US.UTF-8"
#export LC="en_US.UTF-8"
#export LC_CTYPE="en_US.UTF-8"
#export LESSCHARSET="utf-8"
#export BREAK_CHARS="\"#'(),;\`\\|\!?[]{}"
# }}} - LOCALE ---------------------------------------------------------------

# {{{ - UMASK ----------------------------------------------------------------
# single user system (ubuntu default): go-w
umask 022
# multi user system umask: g-w, o-rwx
#umask 027
# multi user system umask: o-rwx
#umask 007
# }}} - UMASK ----------------------------------------------------------------

# {{{ - SYSTEM/ENV STATE -----------------------------------------------------
# System basics
OS="${OS:=${$(uname 2> /dev/null):l}}"
HOST=${HOST:=${$(hostname 2> /dev/null):l}}

# Is X available? Unreliable for ssh x-forwading., suffices for local sessions
IS_X=$([[ ! -t 0 ]] && xset b off >& /dev/null && print true || print false)

# Is Docker Environment?
IS_DOCKER=$([[ -f /.dockerenv || -f /run/.containerenv ]] && print true || print false)

# Are we in a Windows Subsystem Linux?
IS_WSL=false
if [[ ! $IS_DOCKER && $(uname -r) = *icrosoft* ]]; then
  IS_WSL=true
  IS_WSL1=true
  IS_WSL2=false
  if uname -r | tr '[:upper:]' '[:lower:]' | grep wsl2 >/dev/null; then
    IS_WSL1=false
    IS_WSL2=true
  fi
  #export PATH="$PATH:$(wslpath "$(wslvar USERPROFILE)")/bin"
  # See https://github.com/Microsoft/BashOnWindows/issues/1887
  unsetopt BG_NICE
  export DISPLAY=:0
fi
# }}} - SYSTEM/ENV STATE -----------------------------------------------------

# {{{ - DEV ------------------------------------------------------------------
export CLASSPATH=".:$HOME/.class${CLASSPATH+:$CLASSPATH}"
export PYTHONPATH="${PYTHONPATH+:$PYTHONPATH}:$HOME/lib/python/site-packages"
export SCALA_HOME="$HOME/scala"
command -v java >& /dev/null \
  && export JAVA_HOME="${$(realpath $(command -v java))/bin\/java/}"
export ARCH="$(uname -m)"

# Check if we are in the 32bit chroot
#export INCHROOT=0
#if [[ -z "$(mount -l -t ext3 | grep 'on / type')" ]]; then
#if [[ ! -d "/usr/lib64/" ]]; then
#  export DISPLAY=":0"
#  export INCHROOT=1
#  export ARCH=i686
#  # Change prompt color if in chroot
#  export PS1="$(print '%{\e[0;37m%}(%~)%{\e[0m%}
#[%{\e[0;32m%}%n%{\e[0m%}@%m]%# ')"
#  # Mount Radeon Shared Memory TMPFS
#  #[ -z "$(mount|grep shm)" ]] && sudo mount /dev/shm/
#  alias cb="cd ~/; su cbaoth"
#fi

# GCC/G++ Optimization Flags
#case $ARCH in
#  x86_64)
#    export CHOST="x86_64-pc-linux-gnu"
#    # amd: k8, opteron, athlon64, athlon-fx
#    # intel: core2 (gcc 4.3+), nocona
#    export CFLAGS="-march=core2 -pipe -O2" # -m64
#    ;;
#  i686)
#    export CHOST="i686-pc-linux-gnu"
#    # amd: athlon, athlon-tbird, athlon-4, athlon-xp, athlon-mp
#    # intel: prescott, pentium4
#    export CFLAGS="-march=prescott -pipe -O2 -fomit-frame-pointer"
#    ;;
#esac
#export CXXFLAGS="${CFLAGS}"
#export MAKEFLAGS="-j5" # -j2 + extra cores (job count)
# }}} - DEV ------------------------------------------------------------------

# {{{ - DBMS -----------------------------------------------------------------
#export ORACLE_SID=XE
#export ORACLE_HOME="/usr/lib/oracle/xe/app/oracle/product/10.2.0/server"
#export PATH="$PATH:$ORACLE_HOME/bin"
# }}} - DBMS -----------------------------------------------------------------

# {{{ - CUSTOM VARIABLES -----------------------------------------------------
# globally raise (but never lower) the default debug level of cl::p_dbg
export DBG_LVL=0
# }}} - CUSTOM VARIABLES -----------------------------------------------------
# }}} = ENVIRONMENT (ALL SHELLS) =============================================

# {{{ = ENVIRONMENT (INTERACTIVE SHELL ONLY) =================================
# {{{ - SHELL TOOLS ----------------------------------------------------------
# Make `less` not strip color coding, if source doesn't strip it (most do
# when pide, but some support e.g. `--color=always`)
export LESS="-R"

# Enable general highlighting in less (if tools available on system)
# https://superuser.com/a/337640
# Note: Ensure that ~/.lessfilter is executable: chmod u+x ~/.lessfilter
[[ -x ~/.lessfilter ]] \
  && command -v pygmentize >& /dev/null \
  && export LESSOPEN="|~/.lessfilter %s"
# Enable auto extraction of zip files (e.g.: less log.gz)
# This supports a custom ~/.lessfilter as well
command -v lesspipe >& /dev/null \
  && eval "$(lesspipe)"
# }}} - SHELL TOOLS ----------------------------------------------------------
# }}} = ENVIRONMENT (INTERACTIVE SHELL ONLY) =================================

# {{{ = X11/WAYLAND SESSIONS AND RELATED =====================================
# {{{ - CORE -----------------------------------------------------------------
export TERM="xterm-256color" # rxvt, xterm-color, xterm-256color
#export COLORTERM=xterm
#[ -n "$(echo $TERMCAP|grep -i screen)" ]] && TERM=screen
# }}} - CORE -----------------------------------------------------------------

# {{{ - XDG Base Directory ---------------------------------------------------
# https://specifications.freedesktop.org/basedir/latest/
export XDG_CONFIG_HOME="${HOME}/.config"
export XDG_CACHE_HOME="${HOME}/.cache"

# The following should be set automatically / via /etc/environment, but in case it is not:
if [[ -z "${XDG_DATA_DIRS-}" ]]; then
    export XDG_DATA_DIRS="${HOME}/.local/share/flatpak/exports/share:${HOME}/.local/share"\
":/var/lib/flatpak/exports/share:/usr/local/share/:/usr/share/gnome:/usr/share/"
# if flatpak paths are missing, only add those and local user paths
elif [[ ${XDG_DATA_DIRS} != *flatpak* ]]; then
    export XDG_DATA_DIRS="${HOME}/.local/share/flatpak/exports/share:${HOME}/.local/share"\
":/var/lib/flatpak/exports/share"\
"${XDG_DATA_DIRS:+:${XDG_DATA_DIRS}}"
fi
# Note that this is mainly here to avoid warnings from flatpak.
# To be effective for desktop sessions, this should be set in
# /etc/environment, ~/.xsession, or similar. Otherwise some apps may not be
# found due to missing search path entries.
# }}} - XDG Base Directory ---------------------------------------------------
# }}} = X11/WAYLAND SESSIONS AND RELATED =====================================


# {{{ = MISCELLANEOUS ========================================================
# {{{ - IRC ------------------------------------------------------------------
export IRCNICK="cbaoth"
export IRCNAME="Jorus C'Baoth"
#export IRCUSER="cbaoth"
# }}} - IRC ------------------------------------------------------------------

# {{{ - WEB BROWSER ----------------------------------------------------------
#UAGENT="Mozilla/5.0 (X11; U; FreeBSD i386; en-US; rv:1.4b) Gecko/20030517 Mozilla Firebird/0.6"
UAGENT="Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:143.0) Gecko/20100101 Firefox/143.0"
#UAGENT="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"
#UAGENT="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36 Edg/143.0.0.0"
export UAGENT
# }}} - WEB BROWSER ----------------------------------------------------------
# }}} = MISCELLANEOUS ========================================================
